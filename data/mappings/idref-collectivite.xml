<?xml version="1.0" encoding="UTF-8"?>
<!--
    IdRef Collectivité (Organization) mapping for Omeka S.
    Converts Unimarc XML from IdRef authority records to Omeka resource format.

    @see https://www.idref.fr
    @see http://documentation.abes.fr/aideidrefdeveloppeur/index.html
-->
<mapping>
    <info>
        <label>IdRef - Collectivité</label>
        <from>xml</from>
        <to>omeka</to>
        <querier>xpath</querier>
    </info>

    <maps>
        <!-- Static: Resource class (foaf:Organization) -->
        <map>
            <to field="o:resource_class" datatype="resource:class"/>
            <mod raw="foaf:Organization"/>
        </map>

        <!-- Static: Resource template -->
        <map>
            <to field="o:resource_template" datatype="resource:template"/>
            <mod raw="Collectivité"/>
        </map>

        <!-- foaf:name - Full name from 900$a -->
        <map>
            <from xpath="/record/datafield[@tag='900']/subfield[@code='a']"/>
            <to field="foaf:name"/>
        </map>

        <!-- dcterms:language - Language from 101$a with LOC vocabulary URI -->
        <map>
            <from xpath="/record/datafield[@tag='101']/subfield[@code='a'][1]"/>
            <to field="dcterms:language" datatype="valuesuggest:lc:iso6392"/>
            <mod pattern="http://id.loc.gov/vocabulary/iso639-2/{{ value }}"/>
        </map>

        <!-- bio:place - Country from 102$a (requires geonames lookup) -->
        <map>
            <from xpath="/record/datafield[@tag='102']/subfield[@code='a'][1]"/>
            <to field="bio:place" datatype="valuesuggest:geonames:geonames"/>
            <mod pattern="{{ value|table(geonames) }}"/>
        </map>

        <!-- bio:birth - Creation date from 103$a (Unimarc format) -->
        <map>
            <from xpath="/record/datafield[@tag='103']/subfield[@code='a'][1]"/>
            <to field="bio:birth" datatype="numeric:timestamp"/>
            <mod pattern="{{ value|dateIso }}"/>
        </map>

        <!-- bio:death - Dissolution date from 103$b -->
        <map>
            <from xpath="/record/datafield[@tag='103']/subfield[@code='b'][1]"/>
            <to field="bio:death" datatype="numeric:timestamp"/>
            <mod pattern="{{ value|dateIso }}"/>
        </map>

        <!-- bio:biography - Description from 340$a -->
        <map>
            <from xpath="/record/datafield[@tag='340']/subfield[@code='a'][1]"/>
            <to field="bio:biography"/>
        </map>

        <!-- bibo:identifier - IdRef URI from controlfield 003 -->
        <map>
            <from xpath="/record/controlfield[@tag='003']"/>
            <to field="bibo:identifier" datatype="valuesuggest:idref:corporation"/>
        </map>
    </maps>
</mapping>
